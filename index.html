<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Werewolf Moderator - Master Version</title>
  <style>
    body { 
      background-color: #1a1a2e; color: white; font-family: sans-serif;
      display: flex; flex-direction: column; align-items: center; 
      justify-content: center; min-height: 100vh; margin: 0; transition: background 2s;
    }
    .container { text-align: center; width: 90%; max-width: 500px; }
    
    /* Card Styles */
    .card {
      width: 180px; height: 260px; background: #16213e; border: 3px solid #e94560;
      border-radius: 15px; display: flex; align-items: center; justify-content: center;
      cursor: pointer; font-size: 1.5rem; margin: 20px auto;
    }

    /* Player List & Buttons */
    .player-list { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 20px 0; }
    .player-btn { 
      padding: 15px; background: #1a1a2e; border: 2px solid #4e9af1; 
      color: white; border-radius: 8px; cursor: pointer;
    }

    /* Witch Controls */
    .witch-controls { display: flex; gap: 10px; justify-content: center; margin-top: 20px; }
    .witch-btn { padding: 10px 20px; border-radius: 5px; cursor: pointer; border: none; font-weight: bold; color: white; }
    .save { background: #2ecc71; }
    .poison { background: #e74c3c; }

    #timerDisplay { font-size: 3rem; color: #e94560; margin: 10px; }
    #mainAction { padding: 15px 30px; font-size: 1rem; cursor: pointer; background: #e94560; color: white; border: none; border-radius: 8px; }
    .hidden { display: none !important; }
  </style>
</head>
<body>

  <div class="container">
    <h1 id="status">Lobby</h1>
    
    <div id="setupArea">
      <p id="instruction">Tap the card to see your role</p>
      <div class="card" id="roleCard" onclick="revealRole()">?</div>
      <button id="mainAction" class="hidden" onclick="startNight()">START NIGHT PHASE</button>
    </div>

    <div id="nightArea" class="hidden">
      <div id="timerDisplay">30</div>
      <p id="roleInstruction"></p>
      
      <div id="playerInteraction" class="player-list hidden"></div>

      <div id="witchUI" class="witch-controls hidden">
        <button class="witch-btn save" onclick="witchAction('save')">SAVE VICTIM</button>
        <button class="witch-btn poison" onclick="witchAction('poison')">USE POISON</button>
      </div>
    </div>

    <div id="morningArea" class="hidden">
      <h2 id="morningNews">Checking survivors...</h2>
      <div id="hunterZone" class="hidden">
        <p>ðŸŽ¯ The Hunter was killed! Take a shot!</p>
        <div id="hunterTargets" class="player-list"></div>
      </div>
    </div>

  </div>


  <script>

<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>

<script>
  // 1. Your web app's Firebase configuration (Copy this from Firebase Console)
  const firebaseConfig = {
    apiKey: "AIzaSyCjdJYEjdZb-5OQxyBYSfXxVD9y5aaCh64",
  authDomain: "werewolfgame-7386c.firebaseapp.com",
  projectId: "werewolfgame-7386c",
  storageBucket: "werewolfgame-7386c.firebasestorage.app",
  messagingSenderId: "37154052928",
  appId: "1:37154052928:web:ea8671e645f8cbf62038a5",
  measurementId: "G-1VYE9RRKVJ"
  };

  // 2. Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  const database = firebase.database();

  // 3. The "Multiplayer" Logic
  function startNight() {
    // Instead of just changing your own screen, 
    // we tell the database: "The game state is now NIGHT"
    database.ref('gameState').set({
      phase: "NIGHT",
      timestamp: Date.now()
    });
  }

  // 4. THE MAGIC: This listens for changes from OTHER players
  database.ref('gameState').on('value', (snapshot) => {
    const data = snapshot.val();
    
    if (data.phase === "NIGHT") {
      // Every player's phone will execute this code at the same time!
      triggerNightUI();
    }
  });

  function triggerNightUI() {
    document.getElementById('setupArea').classList.add('hidden');
    document.getElementById('nightArea').classList.remove('hidden');
    document.body.style.backgroundColor = "black";
    speak("The village falls asleep...");
  }
</script>    

  </script>
</body>
</html>
